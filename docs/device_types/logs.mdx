# Логгирование данных на основе параметров устройства

## О поле
Чтобы в журнале событий появлялись сообщения нужно настроить логгирование данного девайс типа.

Настройка данного поля требует выполнение не только заполнения поля в типе, но и создания шаблона сообщения.

<Info>Поле имеет ключ `fieldsToLog`</Info>
Данное поле принимает в себя джсон, в котором ключами являются логгируемые поля. Ключами логгируемого поля являются все возможные значения данного поля, а значением данного поля являются ID шаблона сообщения.

Вот один из примеров заполнения данного поля:
```json
"fieldsToLog":{
    "water_leak": {
        "false": 8,
        "true": 7
    }
}
```

`water_leak` - логгируемое поле (ключ из MQTT).<br/>
`true`/`false` - возможные значения логгируемого поля<br/>
а `8` и `7` - ID шаблонов

## О шаблонах

Мы не можем магическим образом понимать, что за текст должен быть у сообщения, поэтому существуют шаблоны.

О том, как создать шаблон смотрите раздел API.

Но мы рассмотрим примеры шаблонов, которые использовались выше:
```json
{
    "id": "198e9691-f221-4a53-a1e7-fa516365d12e",
    "description": "«{sensorName}» зафиксировал протечку в комнате «{roomName}»",
    "code": 7
},
{
    "id": "543f0b2b-cd62-48a3-a0df-b0d7a2354a17",
    "description": "Протчека в зоне «{sensorName}» устранена",
    "code": 8
},
```

Как видим у них есть `description`, который собственно и хранит в себе шаблон, а также есть `code`, который и хранит в себе ID шаблона.
В description мы пишем абсолютно любой текст, а на местах, где надо подставить какое-то значение мы пишем фигурные скобки и название значения.

Допустимые базовые значения в скобках:<br/>
`sensorName` - название сенсора (устройства)<br/>
`roomName` - название комнаты, в котором находится устройство<br/>

Но также мы можем указать заначение устройства по ключу, например:
```json
{
    "id": "a73d5ab2-bde8-4797-a9fd-de585205e485",
    "description": "Новая температура в окружении «{sensorName}» равна {temperature}",
    "code": 9
},
```

Тут мы видим ключ `{temperature}`, который обязательно указывается в fieldsToLog.

К слову о том, как логгировать `>` и `<`, вот пример:
```json
"fieldsToLog":{
    "temperature": {
        "MTMax":12,
        "LTMin": 13,
        "BTN": 9
    },
    "humidity": {
        "MTMax":12,
        "LTMin": 13,
        "BTN": 9
    }
},
```

Соответственно `MTMax` - максимально допустимое значение<br/>
`MTMin` - минимально допустимое значение<br/>
`BTN` -  нормальное значения<br/>